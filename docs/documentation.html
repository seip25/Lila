<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="color-scheme" content="light dark">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="canonical" href="https://seip25.github.io/Lila/" />
    <title>Lila Framework - Python Web Framework</title>
    <meta name="google-site-verification" content="X_F63szaGUDmU8TZv_IJ0GvT79Cfncj5YqBJHTKp1t0" />
    <meta name="description"
        content="Lila is a minimalist Python framework based on Starlette and Pydantic, designed for simplicity, flexibility, and high performance.">
    <meta name="keywords" content="Python, Web Framework, API, Starlette, Pydantic, SQLAlchemy, JWT">
    <meta name="author" content="Lila Framework Team">

    <!-- Spanish Meta Tags -->
    <meta name="description" lang="es"
        content="Lila es un framework minimalista de Python basado en Starlette y Pydantic, dise√±ado para ser simple, flexible y de alto rendimiento.">
    <meta name="keywords" lang="es" content="Python, Framework Web, API, Starlette, Pydantic,  SQLAlchemy, JWT">

    <!-- Open Graph / Facebook -->
    <meta property="og:title" content="Lila Framework - Minimalist Python Web Framework">
    <meta property="og:description"
        content="Lila is a minimalist Python framework based on Starlette and Pydantic, designed for simplicity, flexibility, and high performance.">
    <meta property="og:image" content="https://seip25.github.io/Lila/img/lila.png">
    <meta property="og:url" content="https://seip25.github.io/Lila/">
    <meta property="og:type" content="website">

    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Lila Framework - Minimalist Python Web Framework">
    <meta name="twitter:description"
        content="Lila is a minimalist Python framework based on Starlette and Pydantic, designed for simplicity, flexibility, and high performance.">
    <meta name="twitter:image" content="https://seip25.github.io/Lila/img/lila.png">

    <!-- Multi-language support -->
    <meta name="language" content="en, es">
    <meta http-equiv="Content-Language" content="en, es">

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="https://seip25.github.io/Lila/img/lila.png" alt="Lila Framework Logo">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="css/pico.min.css">
    <link rel="stylesheet" href="css/atom-one-dark.min.css">
    <link rel="stylesheet" href="css/index.css">
    <link rel="stylesheet" href="css/doc.css">

    <!-- Highlight.js -->
    <script src="js/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>

    <!-- Scripts -->
    <script src="js/index.js"></script>

</head>

<body>
    <header class="container">
        <nav>
            <ul>
                <li>
                    <a href="index.html">
                        <h1 class="text-lila">Lila Framework</h1>
                    </a>
                </li>
            </ul>
            <ul>

                <li>
                    <details class="dropdown">
                        <summary>üåê</summary>
                        <ul dir="rtl">
                            <li><a href="esp/documentation.html">Espa√±ol</a></li>
                            <li><a href="documentation.html">English</a></li>
                        </ul>
                    </details>
                </li>
            </ul>
        </nav>
    </header>
    <main class="container ">

        <div class="grid">
            <aside>
                <header>
                    <nav>

                        <ul>

                            <li><a href="#install-eng">Installation</a></li>
                            <li><a href="#routes-eng">Routes</a></li>
                            <li><a href="#static-eng">Static</a></li>
                            <li><a href="#templates-eng">Templates</a></li>
                            <li><a href="#react-seo">React</a></li>
                            <li><a href="#upload-eng">Uploads Files</a></li>
                            <li><a href="#markdown-eng">Markdown/HTML</a></li>
                            <li><a href="#locales-eng">Internationalization (Translations)</a></li>
                            <li><a href="#models-eng">Models</a></li>
                            <li><a href="#middlewares-eng">Middlewares</a></li>
                            <li><a href="#connections-eng">Connections</a></li>
                            <li><a href="#migrations-eng">Migrations</a></li>
                            <li><a href="#rest_api_crud-eng">API Rest crud generate</a></li>
                            <li><a href="#admin-panel-eng">Admin Panel</a></li>
                            <li><a href="#minify-eng">Minify JS,CSS and HTML</a></li>
                            <li><a href="#production-eng">Production</a></li>
                            <!-- <li><a href="#helpers-eng">Helpers</a></li> -->
                        </ul>

                    </nav>
                </header>
            </aside>

            <div class="main">
                <div id="search">
                    <input type="search" name="search" id="searchBox" placeholder="Search..."
                        onkeyup="searchDocs(false,'eng')" />
                    <ul id="searchResults"></ul>
                </div>

                <div id="doc">
                    <div id="doc-eng">

                        <article id="install-eng">
                            <h2>Installation</h2>
                            <div class="terminal">
                                <div class="terminal-encabezado">
                                    <span class="terminal-titulo">Installation</span>
                                    <div class="terminal-controles">
                                        <div class="control cerrar"></div>
                                        <div class="control minimizar"></div>
                                        <div class="control maximizar"></div>
                                    </div>
                                </div>
                                <div class="terminal-contenido">
                                    <span class="comando">$ python -m venv venv # Or python3 -m venv venv</span><br>
                                    <span class="comando">$ source venv/bin/activate # On Windows use
                                        `venv\Scripts\activate`</span><br>
                                    <span class="comando">$ pip install lila-framework</span><br>
                                    <span class="comando">$ lila-init</span><br>
                                    <span class="comando">$ python main.py #Or python3 main.py</span><br>
                                    <span class="cursor"></span>
                                </div>
                            </div>

                        </article>
                        <hr />

                        <article id="app-py-eng">
                            <h5 class=" ">Purpose: Configure and start the application.
                                main.py is the main entry point where the application is configured and initialized.
                            </h5>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">main.py Explanation</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">

                                    <pre><code class="language-python">
from core.app import App
from app.routes.routes import routes
from app.routes.api import routes as api_routes
from core.middleware import Middleware
from app.config import PORT, HOST, DEBUG
from app.middlewares.defaults import (
    LoggingMiddleware,
    IPBlockingMiddleware,
    URLBlockingMiddleware,
    MaliciousExtensionMiddleware,
    SensitivePathMiddleware,
    ErrorHandlerMiddleware,
)
import itertools
import uvicorn
import asyncio

# English: Combining application and API routes into a single list.
# Espa√±ol: Combinando las rutas de la aplicaci√≥n y la API en una √∫nica lista.
all_routes = list(itertools.chain(routes, api_routes))

# English: Here we activate the admin panel with default settings.
# Espa√±ol: Aqu√≠ activamos el panel de administrador con configuraciones predeterminadas.
# from app.routes.admin import Admin
# from app.models.user import User
# admin_routes=Admin(models=[User])
# all_routes = list(itertools.chain(routes, api_routes,admin_routes))
# English: Marker for the admin routes in main.py.
# Espa√±ol: Marcador para las rutas de administrador en main.py.
# admin_marker

cors = None

# English: CORS usage example
# Espa√±ol : Ejemplo de utilizaci√≥n de CORS
# cors={
#     "origin": ["*"],
#     "allow_credentials" : True,
#     "allow_methods":["*"],
#     "allow_headers": ["*"]
# }
# app = App(debug=True, routes=all_routes,cors=cors)

# English:necessary for cli command modify react cors for development
# Espa√±ol:necesario para el comando cli modificar cors de react para desarrollo
# react_marker

middlewares = [
    Middleware(LoggingMiddleware),
    Middleware(IPBlockingMiddleware),
    Middleware(URLBlockingMiddleware),
    Middleware(MaliciousExtensionMiddleware),
    Middleware(SensitivePathMiddleware),
    Middleware(ErrorHandlerMiddleware),
]

# English: Initializing the application with debugging enabled and the combined routes.
# Espa√±ol: Inicializando la aplicaci√≥n con la depuraci√≥n activada y las rutas combinadas.
app = App(debug=DEBUG, routes=all_routes, cors=cors, middleware=middlewares)

# English: To ensure SEO (bots, AI), caching, and HTML hydration, uncomment these lines.
# Adding {% include "react/cache/index.html" %} to <div id="root">
# Espa√±ol :Para tener seo (bots,ia) ,cache y que react hidrate el html ,descomenta estas lineas.
# Agregadando en <div id="root"> ,  {% include "react/cache/index.html"  %}

# import subprocess
# import sys

# @app.on_event("startup")
# async def startup_event():
#     print("‚ôªÔ∏è Prerender for react...")
#     url_with_port =f" http://{HOST}:{PORT}"
#     subprocess.Popen([
#     sys.executable,
#     "-m",
#     "cli.prerender",
#     "--url",
#     url_with_port.strip()
# ])


# English: Asynchronous main function to run the application server.
# Espa√±ol: Funci√≥n principal as√≠ncrona para ejecutar el servidor de la aplicaci√≥n.
async def main():
    # English: Starting the Uvicorn server with the application instance.
    # Espa√±ol: Iniciando el servidor Uvicorn con la instancia de la aplicaci√≥n.
    uvicorn.run("main:app", host=HOST, port=PORT, reload=True)


# English: Entry point for the script, running the main asynchronous function.
# Espa√±ol: Punto de entrada del script, ejecutando la funci√≥n principal as√≠ncrona.
if __name__ == "__main__":
    try:
        asyncio.run(main())
    except KeyboardInterrupt:
        # English: Gracefully shutting down the application on keyboard interrupt.
        # Espa√±ol: Apagando la aplicaci√≥n de manera ordenada al interrumpir con el teclado.
        print("Shutting down the application...")
        pass
                </code>
            </pre>
                                </div>
                            </div>
                        </article>

                        <article id="routes-eng">
                            <h1>Routes</h1>

                            <p>Routes are the access points to the application. In Lila, routes are defined in the
                                <code>routes</code> directory (by default, but you can place them wherever you want) and
                                imported into
                                <code>main.py</code> for use. Routes can be configured to handle HTTP requests, API
                                methods, and
                                more.
                            <p>
                                In addition to JSONResponse you can use HTMLResponse,
                                RedirectResponse and PlainTextResponse, or
                                StreamingResponse , to transmit data in real-time (useful for
                                streaming video/audio or large responses).

                            </p>
                            Below is an example of how routes are defined in Lila:
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">routes/api.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
                            <code class="language-python">
#Import from core JSONResponse .
from lila.core.responses import JSONResponse 

# Manages routes for API endpoints.
from lila.core.routing import Router  
# Initializes the router instance to handle API app.routes.
router = Router()


# Defines a simple API route that supports the GET method.
@router.route(path='/api', methods=['GET'])
async def api(request: Request):
"""Api function"""
# English: Returns a simple JSON response for API verification.
return JSONResponse({'api': True})   
                            </code>
                        </pre>
                                </div>
                            </div>

                            <br />

                            <h5>Get url parameteres</h5>
                            <p>In this function, we receive a parameter via
                                the URL using <code>{param}</code>.
                                If the parameter is not provided,
                                it defaults to <code>'default'</code>.
                                The response is a JSON containing the received value.</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Receiving GET Parameters</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
        <code class="language-python">
@router.route(path='/url_with_param/{param}', methods=['GET']) 
async def param(request: Request):  
    param = request.path_params.get('param', 'default') 
    return JSONResponse({"received_param": param})
        </code>
        </pre>
                                </div>
                            </div>
                            <br />
                            <p>Or you canl also do it like this

                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Receiving GET Query parameters</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
        <code class="language-python"> 
@router.route(path='/url_with_param/?query_param', methods=['GET','POST']) 
async def query_param(request: Request):  
    query_param= request.query_params.get('query_param', 'query_param')
    return JSONResponse({"received_param": query_params})
                            
        </code>
        </pre>
                                </div>
                            </div>
                            <br />
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Basic Imports</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
        <code class="language-python">
from lila.core.responses import JSONResponse  # Simplifies sending JSON responses.
from lila.core.routing import Router  # Manages API app.routes.
from lila.core.request import Request  # Handles HTTP requests in the application.
from pydantic import EmailStr, BaseModel  # Validates and parses data models for input validation.
from app.helpers.helpers import get_user_by_id_and_token
from app.middlewares.middlewares import validate_token

router = Router()
        </code>
        </pre>
                                </div>
                            </div>

                            <h5>Middleware and Decorators Usage</h5>
                            <p>Middlewares allow intercepting requests before they reach the main logic of the API.
                                In this example, we use <code>@validate_token</code> to validate a JWT token in the
                                request
                                header.</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Middleware Validation</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
        <code class="language-python">
@router.route(path='/api/token', methods=['GET','POST'])
@validate_token  # Middleware to validate JWT token.
async def api_token(request: Request):
    return JSONResponse({'api': True})
        </code>
        </pre>
                                </div>
                            </div>

                            <h5>Data Validation with Pydantic</h5>
                            <p>Pydantic allows defining data models that automatically validate user input.
                                Additionally, specifying a model in the route generates automatic documentation in
                                <code>/docs</code>.
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Validation with Pydantic</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
        <code class="language-python">

from pydantic import EmailStr, BaseModel 
class ExampleModel(BaseModel):
    email: EmailStr  # Ensures a valid email.
    password: str  # String for password.

@router.route(path='/api/example', methods=['POST'], model=ExampleModel)
async def login(request: Request):
    body = await request.json()
    try:
        input = ExampleModel(**body)  # Automatic validation with Pydantic.
    except Exception as e:
        return JSONResponse({"success": False, "msg": f"Invalid JSON Body: {e}"}, status_code=400) 
    return JSONResponse({"email": input.email, "password": input.password})
        </code>
        </pre>
                                </div>
                            </div>

                            <h5>Automatic Documentation Generation</h5>
                            <p>Thanks to the integration with Pydantic, the API documentation is generated automatically
                                and is
                                accessible from
                                <code>/docs</code>. You can also generate an OpenAPI JSON file for external tools.
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Documentation Generation</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
        <code class="language-python">
router.swagger_ui()  # Enables Swagger UI for API documentation.
router.openapi_json()  # Generates OpenAPI JSON for external tools.
        </code>
        </pre>
                                </div>
                            </div>


                            <h5>Importing Routes in main.py</h5>
                            <p>To use the routes defined in the router, you need to obtain them with
                                <code>router.get_routes()</code> and import them into <code>main.py</code>.
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Route Import</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
        <code class="language-python">
routes = router.get_routes()  # Retrieves all defined app.routes.
        </code>
        </pre>
                                </div>
                            </div>

                        </article>

                        <article id="static-eng">
                            <h1>Static files</h1>
                            <p>To load static files(js,css,etc) you can use the <code>mount()</code> method.
                            </p>
                            <p>What will be received as parameters that trade by default
                                <code>path: str = '/public', directory: str = 'static', name: str = 'static'</code>
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Static</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
<code class="language-python">
from lila.core.routing import Router
# Creating an instance of the Router to define the routes, if it was not previously created in the file
router = Router()
# Mounting the static files in the 'static' folder, url ='/public' by default
router.mount()
</code> 
</pre>
                                </div>
                            </div>
                        </article>

                        <article id="templates-eng">
                            <h1>Templates Render (Jinja2 + Lila JS)</h1>
                            <p><strong>
                                    In Lila, you can use Jinja2 to render HTML with server-side data or Lila JS
                                    to create reactive client-side components,
                                    or even combine both approaches according to your needs.
                                </strong></p>

                            <section>
                                <h2>Rendering Options</h2>
                                <p>Lila offers three approaches to build your application:</p>

                                <div class="feature-cards">
                                    <div class="card">
                                        <h3>1. Traditional Jinja2</h3>
                                        <p>Full server-side rendering using Jinja2 templates with context data.</p>
                                        <div class="code-editor small">
                                            <div class="editor-content">
                                                <pre><code class="language-html">
&lt;p&gt;{{ translate['Welcome'] }} {{ user.name }}&lt;/p&gt;
                                                </code></pre>
                                            </div>
                                        </div>
                                        <p><strong>Advantages:</strong> Perfect SEO, fast initial load, simple.</p>
                                    </div>

                                    <div class="card">
                                        <h3>2. Lila JS (SPA)</h3>
                                        <p>Fully reactive single-page application on the client side.</p>
                                        <div class="code-editor small">
                                            <div class="editor-content">
                                                <pre><code class="language-html">
&lt;span data-bind="message"&gt;&lt;/span&gt;
&lt;input data-model="username"&gt;
                                                </code></pre>
                                            </div>
                                        </div>
                                        <p><strong>Advantages:</strong> Fluid user experience, no page reloads.</p>
                                    </div>

                                    <div class="card">
                                        <h3>3. Hybrid Approach</h3>
                                        <p>Combine Jinja2 for base structure and Lila JS for interactive parts.</p>
                                        <div class="code-editor small">
                                            <div class="editor-content">
                                                <pre><code class="language-html">
&lt;div data-component="InteractivePart"&gt;&lt;/div&gt;
&lt;p&gt;{{ static_content }}&lt;/p&gt;
                                                </code></pre>
                                            </div>
                                        </div>
                                        <p><strong>Advantages:</strong> The best of both worlds.</p>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <h2>Render with Jinja2</h2>
                                <p><strong>
                                        In Lila, Jinja2 is used by default to render HTML templates and send them to the
                                        client.
                                        With <code>context</code>, you can pass information such as translations, data,
                                        values, lists, dictionaries or whatever you need.
                                    </strong></p>

                                <p>The parameters that the <code>render</code> function from
                                    <code>lila.core.templates</code>
                                    can receive are:
                                </p>
                                <div class="code-editor">
                                    <div class="editor-content">
                                        <pre><code class="language-python">
request: Request, 
template: str, 
context: dict = {}, 
theme_: bool = True,
translate: bool = True, 
files_translate: list = []
                                        </code></pre>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <h2>Lila JS: Reactive System</h2>
                                <p>Lila JS is a minimalist library to create reactive interfaces with vanilla
                                    JavaScript.</p>
                                <p><a href="https://github.com/seip25/Lila_js" target="_blank">Documentation</a></p>

                                <h3>Key Concepts</h3>
                                <div class="concept-grid">
                                    <div class="concept">
                                        <h4>Reactive State</h4>
                                        <p>State is a special object that automatically updates the UI when it changes.
                                        </p>
                                        <div class="code-editor small">
                                            <div class="editor-content">
                                                <pre><code class="language-javascript">
state: () => ({
    email: '',
    password: ''
})
                                                </code></pre>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="concept">
                                        <h4>Two-Way Data Binding</h4>
                                        <p>Bidirectional binding between inputs and state using <code>data-model</code>.
                                        </p>
                                        <div class="code-editor small">
                                            <div class="editor-content">
                                                <pre><code class="language-html">
&lt;input data-model="email"&gt;
&lt;span data-bind="email"&gt;&lt;/span&gt;
                                                </code></pre>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="concept">
                                        <h4>Components</h4>
                                        <p>Reusable units with their own state, template and actions.</p>
                                        <div class="code-editor small">
                                            <div class="editor-content">
                                                <pre><code class="language-javascript">
App.createComponent('Login', {
    template: 'login-template',
    state: () => ({...}),
    actions: {...}
});
                                                </code></pre>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="concept">
                                        <h4>Routing</h4>
                                        <p>Client-side navigation between components.</p>
                                        <div class="code-editor small">
                                            <div class="editor-content">
                                                <pre><code class="language-javascript">
App.addRoute('/login', 'Login');
handleRouting();
                                                </code></pre>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <h2>Complete Example: Authentication System</h2>
                                <p>This example shows how to combine Jinja2 for the base structure and Lila JS for
                                    interactivity.</p>

                                <h3>auth.html - Base Structure</h3>
                                <div class="code-editor">
                                    <div class="editor-header">
                                        <span class="editor-title">templates/html/auth.html</span>
                                    </div>
                                    <div class="editor-content">
                                        <pre><code class="language-html">
&lt;!DOCTYPE html&gt;
&lt;html lang="{{lang}}"&gt;
&lt;head&gt;
    &lt;meta charset="UTF-8"&gt;
    &lt;title&gt;{{title}}&lt;/title&gt;
    &lt;link rel="stylesheet" href="/public/css/styles.css" /&gt;
    &lt;script src="/public/js/lila.js"&gt;&lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;main id="app-lila" class="container"&gt;&lt;/main&gt;
    {% include 'auth/login.html' with context %}
    {% include 'auth/register.html' with context %}
    {% include 'auth/footer.html' with context %}
    &lt;script&gt;
        handleRouting();
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
                                        </code></pre>
                                    </div>
                                </div>
                                <p><strong>Explanation:</strong> This file serves as the base layout using Jinja2. It
                                    includes:</p>
                                <ul>
                                    <li>Translations from context with <code>{{lang}}</code> and <code>{{title}}</code>
                                    </li>
                                    <li>A main container <code>app-lila</code> where components will be mounted</li>
                                    <li>Inclusion of partial templates for login, register and footer</li>
                                    <li>Router initialization with <code>handleRouting()</code></li>
                                </ul>

                                <h3>login.html - Reactive Component</h3>
                                <div class="code-editor">
                                    <div class="editor-header">
                                        <span class="editor-title">templates/html/auth/login.html</span>
                                    </div>
                                    <div class="editor-content">
                                        <pre><code class="language-html">
&lt;template data-template="login-template"&gt;
    &lt;div class="flex center"&gt;
        &lt;article class="shadow rounded mx-m"&gt;
            &lt;h1 class="flex center"&gt;{{translate['login']}}&lt;/h1&gt;
            &lt;form data-action="loginFetch"&gt;
                &lt;div class="input-icon"&gt;
                    &lt;i class="icon-email"&gt;&lt;/i&gt;
                    &lt;input type="email" data-model="email" placeholder="Email" required /&gt;
                &lt;/div&gt;
                &lt;div class="input-icon"&gt;
                    &lt;i class="icon-lock"&gt;&lt;/i&gt;
                    &lt;input type="password" data-model="password" 
                            placeholder="{{translate['password']}}" required /&gt;
                &lt;/div&gt;
                &lt;button type="submit"&gt;{{translate['login']}}&lt;/button&gt;
            &lt;/form&gt;
            &lt;a href="/register" data-link&gt;{{translate['register']}}&lt;/a&gt;
        &lt;/article&gt;
    &lt;/div&gt;
    &lt;div data-component="Footer"&gt;&lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
    App.createComponent('Login', {
        template: 'login-template',
        state: () => ({
            email: '',
            password: ''
        }),
        actions: {
            loginFetch: async ({ state, event }) => {
                event.preventDefault();
                const data = { email: state.email, password: state.password };
                alert('Login: ' + JSON.stringify(data));
            }
        }
    });
    
    App.addRoute('/login', 'Login');
    App.addRoute('*', 'Login'); // Default route
&lt;/script&gt;
                                        </code></pre>
                                    </div>
                                </div>
                                <p><strong>Key Features:</strong></p>
                                <ul>
                                    <li><strong>Two-way data binding:</strong> Inputs with <code>data-model</code>
                                        automatically sync with state.</li>
                                    <li><strong>Actions:</strong> <code>data-action</code> binds the form to the
                                        <code>loginFetch</code> method.
                                    </li>
                                    <li><strong>Nested component:</strong> Footer is included with
                                        <code>data-component="Footer"</code>.
                                    </li>
                                    <li><strong>Routing:</strong> Links with <code>data-link</code> navigate without
                                        page reload.</li>
                                    <li><strong>Combination with Jinja2:</strong> Use of <code>{{translate}}</code> for
                                        internationalized texts.</li>
                                </ul>

                                <h3>register.html - Component with Validation</h3>
                                <div class="code-editor">
                                    <div class="editor-header">
                                        <span class="editor-title">templates/html/auth/register.html</span>
                                    </div>
                                    <div class="editor-content">
                                        <pre><code class="language-html">
&lt;template data-template="register-template"&gt;
    &lt;div class="flex center container"&gt;
        &lt;article class="shadow rounded mx-m"&gt;
            &lt;h1&gt;{{translate['register']}}&lt;/h1&gt;
            &lt;form data-action="registerFetch"&gt;
                &lt;input type="text" data-model="name" placeholder="{{translate['name']}}"&gt;
                &lt;input type="email" data-model="email" placeholder="Email"&gt;
                &lt;input type="password" data-model="password" placeholder="{{translate['password']}}"&gt;
                &lt;input type="password" data-model="password_2" placeholder="{{translate['confirm_password']}}"&gt;
                &lt;button type="submit"&gt;{{translate['register']}}&lt;/button&gt;
            &lt;/form&gt;
            &lt;div&gt;
                &lt;p&gt;Current values:&lt;/p&gt;
                &lt;p&gt;Name: &lt;span data-bind="name"&gt;&lt;/span&gt;&lt;/p&gt;
                &lt;p&gt;Email: &lt;span data-bind="email"&gt;&lt;/span&gt;&lt;/p&gt;
            &lt;/div&gt;
            &lt;a href="/login" data-link&gt;{{translate['login']}}&lt;/a&gt;
        &lt;/article&gt;
    &lt;/div&gt;
&lt;/template&gt;

&lt;script&gt;
    App.createComponent('Register', {
        template: 'register-template',
        state: () => ({
            name: '',
            email: '',
            password: '',
            password_2: ''
        }),
        actions: {
            registerFetch: async ({ state, event }) => {
                event.preventDefault();
                if (state.password !== state.password_2) {
                    alert("{{translate['passwords_dont_match']}}");
                    return;
                }
                const data = { 
                    name: state.name, 
                    email: state.email, 
                    password: state.password 
                };
                // Send data to server...
            }
        }
    });
    
    App.addRoute('/register', 'Register');
&lt;/script&gt;
                                        </code></pre>
                                    </div>
                                </div>
                                <p><strong>Key Points:</strong></p>
                                <ul>
                                    <li>Shows real-time state values with <code>data-bind</code></li>
                                    <li>Basic validation directly in the action</li>
                                    <li>Combined use of reactive data and static translations</li>
                                </ul>

                                <h3>footer.html - Simple Component</h3>
                                <div class="code-editor">
                                    <div class="editor-header">
                                        <span class="editor-title">templates/html/auth/footer.html</span>
                                    </div>
                                    <div class="editor-content">
                                        <pre><code class="language-html">
&lt;template data-template="footer-template"&gt;
    &lt;footer class="mt-4 container"&gt;
        &lt;div class="flex between"&gt;
            &lt;a href="/set-language/es"&gt;Espa√±ol&lt;/a&gt;
            &lt;a href="/set-language/en"&gt;English&lt;/a&gt;
        &lt;/div&gt;
    &lt;/footer&gt;
&lt;/template&gt;

&lt;script&gt;
    App.createComponent('Footer', {
        template: 'footer-template'
    }); 
&lt;/script&gt;
                                        </code></pre>
                                    </div>
                                </div>
                                <p><strong>Notes:</strong></p>
                                <ul>
                                    <li>Stateless component</li>
                                    <li>Reusable in any part of the application</li>
                                    <li>Doesn't require complex JavaScript logic</li>
                                </ul>
                            </section>

                            <section>
                                <h2>Advantages of This Approach</h2>
                                <div class="advantages">
                                    <div class="advantage">
                                        <h3>üöÄ Performance</h3>
                                        <p>Combines Jinja2's initial speed with SPA fluidity.</p>
                                    </div>
                                    <div class="advantage">
                                        <h3>üîç Optimized SEO</h3>
                                        <p>Critical content is server-rendered for search engine bots.</p>
                                    </div>
                                    <div class="advantage">
                                        <h3>üí° Progressive</h3>
                                        <p>Start with Jinja2 and add interactivity where needed.</p>
                                    </div>
                                    <div class="advantage">
                                        <h3>üõ†Ô∏è Simple</h3>
                                        <p>No complex configuration or heavy dependencies.</p>
                                    </div>
                                </div>
                            </section>

                            <section>
                                <h2>Lila JS Quick Reference</h2>
                                <table class="reference-table">
                                    <thead>
                                        <tr>
                                            <th>Attribute/Function</th>
                                            <th>Description</th>
                                            <th>Example</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td><code>data-component</code></td>
                                            <td>Mounts a component inside another</td>
                                            <td><code>&lt;div data-component="Footer"&gt;&lt;/div&gt;</code></td>
                                        </tr>
                                        <tr>
                                            <td><code>data-bind</code></td>
                                            <td>Displays a state property value</td>
                                            <td><code>&lt;span data-bind="email"&gt;&lt;/span&gt;</code></td>
                                        </tr>
                                        <tr>
                                            <td><code>data-model</code></td>
                                            <td>Two-way binding for inputs</td>
                                            <td><code>&lt;input data-model="username"&gt;</code></td>
                                        </tr>
                                        <tr>
                                            <td><code>data-action</code></td>
                                            <td>Binds an action to an event</td>
                                            <td><code>&lt;button data-action="submit"&gt;</code></td>
                                        </tr>
                                        <tr>
                                            <td><code>data-link</code></td>
                                            <td>Navigation between routes without reload</td>
                                            <td><code>&lt;a href="/about" data-link&gt;</code></td>
                                        </tr>
                                        <tr>
                                            <td><code>App.createComponent</code></td>
                                            <td>Creates a new component</td>
                                            <td><code>App.createComponent('Login', {...});</code></td>
                                        </tr>
                                        <tr>
                                            <td><code>App.addRoute</code></td>
                                            <td>Defines a route for a component</td>
                                            <td><code>App.addRoute('/login', 'Login');</code></td>
                                        </tr>
                                        <tr>
                                            <td><code>handleRouting()</code></td>
                                            <td>Initializes the routing system</td>
                                            <td><code>&lt;script&gt;handleRouting();&lt;/script&gt;</code></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </section>
                        </article>

                        <article id="react-seo">
                            <h1>React Integration with Lila</h1>

                            <p>
                                Lila provides a seamless integration with React, allowing you to develop your frontend
                                with a
                                modified Vite + React setup while keeping strong SEO capabilities, caching, and HTML
                                hydration.
                                This setup ensures your React app can be prerendered and recognized by Google Bots and
                                AI.
                            </p>

                            <h5>Starting a React Project in Lila</h5>
                            <p>
                                To create or run a React project inside Lila, execute the following command:
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">CLI Command</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-bash">
# For Python 3 environments
python3 -m cli.react [--name PROJECT_NAME]

# Or if your default Python is python
python -m cli.react [--name PROJECT_NAME]
            </code></pre>
                                </div>
                            </div>

                            <p>
                                <strong>Parameters:</strong><br>
                                <code>--name</code>: Optional project name, default is <code>"react"</code>.
                            </p>

                            <h5>Development CORS Configuration</h5>
                            <p>
                                When running React in development mode, Lila automatically edits <code>main.py</code> to
                                add the
                                necessary CORS configuration. By default:
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">main.py CORS snippet</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
# English: for development react
# Espa√±ol: para desarrollo react
cors = {
    "origin": ["http://localhost:5173"],
    "allow_credentials": True,
    "allow_methods": ["*"],
    "allow_headers": ["*"]
}
            </code></pre>
                                </div>
                            </div>

                            <h5>Automatic Routes and Asset Mounting</h5>
                            <p>
                                Lila modifies <code>app/routes/routes.py</code> automatically for your React build. This
                                ensures
                                the React build assets are served correctly and the index.html is rendered from the
                                cache.
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">routes.py Example</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
router.mount(path="/assets", directory="templates/html/react/assets", name="react-assets")

@router.route(path="/{path:path}", methods=["GET"])
async def home(request: Request):
    response = render(request=request, template="react/index")
    return response
            </code></pre>
                                </div>
                            </div>
<div>
<h3>
Remember to modify the <code>main.py</code> file when passing your routes
to initialize
the application, always pass <strong>api_routes</strong> first, or whatever you have
named it.
<br/> This is key to getting your API routes without colliding with the general React route.
<code>
@router.route(path="/{path:path}", methods=["GET"])
</code>
, where React, with React Router, or whatever you use, can handle all the routes.
<br /> Remaining this way in <code>main.py</code> 

</h3> 
<div class="code-editor"> 
<div class="editor-header"> 
<span class="editor-title">main.py</span> 
</div> 
<div class="editor-content"> 
<pre> 
<code class="language-python">
all_routes = list(itertools.chain( api_routes,routes))
#First api_routes, then routes (where the general React route is) <pre><code class="language-python"> 
</code> 
</pre> 
</div> 
</div> 

</div>


                            <h5>Prerendering and Caching</h5>
                            <p>
                                To improve SEO, Lila supports prerendering your React pages and caching them. After
                                building your
                                React app with <code>npm run build</code>, you can generate the cached HTML:
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Generate Cache</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-bash">
python -m cli.prerender --url http://localhost:8001
# or python3 -m cli.prerender
            </code></pre>
                                </div>
                            </div>

                            <p>
                                Then, in your <code>react/index.html</code> dev file, include the cached HTML for SEO
                                hydration:
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">index.html snippet</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-html">
<div id="root">{% include "react/cache/index.html" ignore missing %}</div>
            </code></pre>
                                </div>
                            </div>

                            <h5>Startup Integration in main.py</h5>
                            <p>
                                You can optionally execute the prerender automatically on server startup by uncommenting
                                the
                                following section in <code>main.py</code>:
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">main.py prerender on startup</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
# import subprocess
# import sys

# @app.on_event("startup")
# async def startup_event():
#     print("‚ôªÔ∏è Prerender for react...")
#     url_with_port = f"http://{HOST}:{PORT}"
#     subprocess.Popen([
#         sys.executable,
#         "-m",
#         "cli.prerender",
#         "--url",
#         url_with_port.strip()
#     ])
            </code></pre>
                                </div>
                            </div>

                            <h5>SEO and Hydration</h5>
                            <p>
                                By including the cached HTML in the <code>root</code> div, React will rehydrate the
                                content on the
                                client side. This gives you:
                            </p>
                            <ul>
                                <li>Strong SEO recognition by Google Bots and AI.</li>
                                <li>Faster first paint with pre-rendered HTML.</li>
                                <li>Optional daily caching using a scheduled prerender task.</li>
                            </ul>

                            <h5>React Helpers and Context</h5>
                            <p>
                                You can pass context from Jinja2 templates to React using <code>&lt;script&gt;</code>
                                tags in
                                <code>templates/html/react/index.html</code>. Useful for translations, configuration, or
                                any
                                dynamic data.
                            </p>

                            <h5>Automatic API Documentation</h5>
                            <p>
                                Lila continues to generate API documentation automatically using Pydantic models. All
                                helpers
                                and middlewares can be combined seamlessly with React routes.
                            </p>

                            <h5>Session Validation with React</h5>
                            <p>
                                In the backend, you can add a middleware to validate the session. You can also use JWT, but Session is more secure because it is signed by <code>itsdangerous</code>.
                            </p>
                            <p>
                                This way, you can validate requests and store public IDs, tokens, etc., to validate sessions, or you can use JWT or both.
                                The main recommendation is to validate the session this way or with <code>login_required</code>, which is another middleware that can also be configured there.
                                This way, Lila and React are connected for the developer. In production, thanks to the <code>if DEBUG</code> condition, it will be secure with the signature of <code>itsdangerous</code> in the <code>Session</code> class.
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">app/routes/api.py</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
from app.middlewares.middlewares import login_required_auth, check_token, check_session
from lila.core.session import Session
from app.config import DEBUG

# Define a simple API route that supports GET method.
@router.route(path="/api", methods=["GET"])
async def api(request: Request):
    """Api function"""
    # Returns a simple JSON response for API verification.
    response = JSONResponse({"api": True})
    new_val={"id":20}
    samesite="none" if DEBUG else "secure"
    Session.setSession(new_val=new_val,name_cookie='auth',response=response,samesite=samesite)
    return response


# Define an API route that supports GET and POST methods.
@router.route(path="/api/token", methods=["GET", "POST"])
# Middleware to validate the JWT Token.
@login_required_auth
async def api_token(request: Request):
    """Api Token function"""
    print(Session.getSessionValue(request=request))
    return JSONResponse({"api": True})
                                    </code></pre>
                                </div>
                            </div>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">app/middlewares/middlewares.py</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
def login_required_auth(func, key: str = "auth"):
    @wraps(func)
    async def wrapper(request, *args, **kwargs):
        session_data = Session.getSession(request=request,key=key)
        if not session_data:
            return JSONResponse({"session": False, "success": False}, status_code=401)
        return await func(request, *args, **kwargs)
                                    </code></pre>
                                </div>
                            </div>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">React Component</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-javascript">
import { useEffect } from 'react';

function MyComponent() {
  useEffect(() => {
    const start = async () => {
      const resp = await fetch('http://127.0.0.1:8000/api', { credentials: 'include' });

      const resp_ = await fetch('http://127.0.0.1:8000/api/token', { credentials: 'include' });
      const json = await resp_.json();

      console.log(json);
    };
    start();
  }, []);

  return (
    &lt;div&gt;
      {/* Your component JSX */}
    &lt;/div&gt;
  );
}
                                    </code></pre>
                                </div>
                            </div>
                        </article>

                        <article id="lila-js-eng">
                            <h1>Lila JS Documentation</h1>
                            <p>
                                Lila JS is a minimalist JavaScript micro-framework for building modern web applications.
                                It provides a reactive system, routing, and components in a lightweight package.
                            </p>

                            <h2>Core Concepts</h2>

                            <h3>Components</h3>
                            <p>
                                Components are the building blocks of a Lila JS application. They encapsulate a
                                template, state, and actions.
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Component Example</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-javascript">
App.createComponent('Home', {
    template: 'home-template',
    state: () => ({
        message: 'Welcome to Lila JS!'
    }),
    actions: {
        updateMessage: ({ state }) => {
            state.message = 'The message has been updated!';
        }
    }
});
                                    </code></pre>
                                </div>
                            </div>

                            <h3>Routing</h3>
                            <p>
                                Lila JS includes a simple router to map URLs to components.
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Routing Example</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-javascript">
App.addRoute('/', 'Home');
App.addRoute('/about', 'About');
                                    </code></pre>
                                </div>
                            </div>

                            <h3>Initialization</h3>
                            <p>
                                To start the application and handle routing, you need to call `handleRouting()`.
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Initialization Example</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-javascript">
handleRouting();
                                    </code></pre>
                                </div>
                            </div>
                        </article>

                        <article id="api-reference-eng">
                            <h1>API Reference & Examples</h1>

                            <h2>Login Form Example</h2>
                            <p>
                                This example demonstrates how to create a simple login form with validation.
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Login Component</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-html">
&lt;template data-template="login-template"&gt;
    &lt;form data-action="login"&gt;
        &lt;input type="email" data-model="email" placeholder="Email" required&gt;
        &lt;input type="password" data-model="password" placeholder="Password" required&gt;
        &lt;button type="submit"&gt;Login&lt;/button&gt;
    &lt;/form&gt;
&lt;/template&gt;

&lt;script&gt;
    App.createComponent('Login', {
        template: 'login-template',
        state: () => ({
            email: '',
            password: ''
        }),
        actions: {
            login: ({ state, event }) => {
                event.preventDefault();
                if (state.email && state.password) {
                    // Perform login logic here
                    console.log('Logging in with:', state.email, state.password);
                } else {
                    alert('Please fill in all fields.');
                }
            }
        }
    });

    App.addRoute('/login', 'Login');
&lt;/script&gt;
                                    </code></pre>
                                </div>
                            </div>
                        </article>



                        <article id="upload-eng">
                            <h1>File Upload Helper</h1>
                            <p><strong>
                                    The <code>upload</code> helper provides a complete solution for handling file
                                    uploads in your application,
                                    including validation, security checks, and translation support.
                                </strong></p>

                            <p>This helper automatically handles:
                            <ul>
                                <li>HTTP method validation (POST only)</li>
                                <li>Content-Type validation (multipart/form-data)</li>
                                <li>File extension validation</li>
                                <li>File size limits</li>
                                <li>Empty file detection</li>
                                <li>Secure filename handling</li>
                                <li>Automatic directory creation</li>
                                <li>Translation support for error messages</li>
                            </ul>
                            </p>

                            <h2>Parameters</h2>
                            <p>The <code>upload</code> function accepts these parameters:</p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Parameters</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
request: Request          # Starlette request object
name_file: str | list     # Field name for file upload (default: 'file')
UPLOAD_DIR: str           # Directory to save files (default: 'uploads')
ALLOWED_EXTENSIONS: set   # Allowed file extensions (default: {'txt', 'pdf', 'png', 'jpg', 'jpeg', 'gif'})
MAX_FILE_SIZE: int        # Maximum file size in bytes (default: 10MB)
            </code></pre>
                                </div>
                            </div>

                            <h2>Usage Example</h2>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Route Implementation</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
from app.helpers.helpers import upload

@router.route("/upload", methods=["POST"])
async def uploadFile(request: Request):
    response = await upload(request=request, name_file="file")
    return response
                                    </code></pre>
                                </div>
                            </div>

                            <h2>Frontend Implementation</h2>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">HTML + JavaScript</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-html">
&lt;form onsubmit="upload(event);"&gt;
    &lt;fieldset&gt;
        &lt;input type="file" name="file" required&gt;
    &lt;/fieldset&gt;
    &lt;button type="submit"&gt;
        &lt;i class="icon-check-circle"&gt;&lt;/i&gt;
        Upload Files
    &lt;/button&gt;
&lt;/form&gt;

&lt;script&gt;
    async function upload(event) {
        event.preventDefault();
        const formElement = event.target;
        const formData = new FormData(formElement);
        
        try {
            const response = await fetch('/upload', {
                method: 'POST',
                body: formData,
            });
            
            const result = await response.json();
            if (!response.ok) throw new Error(result.message);
            
            alert('File uploaded successfully!');
        } catch (error) {
            alert(error.message);
        }
    }
&lt;/script&gt;
                                    </code></pre>
                                </div>
                            </div>

                            <h2>Response Format</h2>
                            <p>The helper returns a JSONResponse with this structure:</p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Success Response</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-json">
{
    "file": "/uploads/filename.ext",
    "success": true,
    "message": "File uploaded successfully"
}
                                    </code></pre>
                                </div>
                            </div>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Error Response</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-json">
{
    "error": true,
    "success": false,
    "message": "Error message in user's language"
}
                                    </code></pre>
                                </div>
                            </div>
                        </article>
                        <article id="markdown-eng">
                            <h1>Markdown /HTML</h1>
                            <p>To render <code>markdown</code> files, the
                                <code>renderMarkdown</code> function is used, which receives the following parameters:
                                <code>request,file : str , base_path:str ='templates/markdown/',css_files : list = [],js_files:list=[],picocss : bool =False</code>
                            </p>
                            <p>
                                <code>file</code> is the name of the file, starting from the <code>base_path</code> of
                                the
                                directory
                                located in <code>templates/markdown/</code>, for example: <code>index.md</code>.
                                It will look for an <code>index.md</code> file in the markdown directory inside the
                                templates
                                folder
                                (templates/markdown/index.md).
                            </p>
                            <p>
                                <code>css_files</code> and <code>js_files</code> are lists of CSS and JS files that will
                                be
                                loaded in the
                                generated HTML file.
                            </p>
                            <p>
                                <code>picocss</code> is a boolean indicating whether the PicoCSS CSS file should be
                                loaded.
                            </p>
                            <p>
                                Below is an example of how <code>markdown</code> files are rendered in
                                Lilac:
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Markdown</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
                     <code class="language-python">
from lila.core.templates import renderMarkdown

@router.route(path='/markdown', methods=['GET'])
async def home(request: Request):
    #Define a list of CSS files to include in the response
    css = ["/public/css/styles.css"]
    #Renders a markdown file with PicoCSS styling
    response = renderMarkdown(request=request, file='example', css_files=css, picocss=True)
    return response

                     </code>
                     </pre>
                                </div>
                            </div>

                        </article>

                        <article id="locales-eng">
                            <h1>Internationalization (Translations)</h1>
                            <p>Translations are used to internationalize an application and display content in different
                                languages. In Lila, translations are stored in the <code>app/locales</code> directory
                                and
                                can be dynamically loaded into the application.</p>

                            <h2>Forcing Default Language in Routes</h2>
                            <p>The <code>render</code> method accepts a <code>lang_default</code> parameter to force a
                                specific language for the rendered template:</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">app.routes.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
# Force Spanish language
@router.route(path="/es", methods=["GET"])
async def home(request: Request):
    response = render(
        request=request,
        template="index",
        lang_default="es"  # Forces Spanish translations
    )
    return response

# Force English language
@router.route(path="/en", methods=["GET"])
async def home(request: Request):
    response = render(
        request=request,
        template="index",
        lang_default="en"  # Forces English translations
    )
    return response
                                    </code></pre>
                                </div>
                            </div>

                            <h2>Translation Files</h2>
                            <p>To load a locale file, use the <code>translate</code> function from
                                <code>app.helpers.helpers</code>. You can access translations using:
                            </p>
                            <ul>
                                <li><code>translate</code> - returns a dictionary with all translations</li>
                                <li><code>translate_</code> - returns a specific translation (returns original text if
                                    not found)</li>
                            </ul>

                            <p>Example translation file (<code>app/locales/translations.json</code>):</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">app/locales/translations.json</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-json">
{
    "Send": {
        "es": "Enviar",
        "en": "Send"
    },
    "Cancel": {
        "es": "Cancelar",
        "en": "Cancel"
    },
    "Accept": {
        "es": "Aceptar",
        "en": "Accept"
    },
    "Email": {
        "es": "Email",
        "en": "Email"
    },
    "Name": {
        "es": "Nombre",
        "en": "Name"
    },
    "Back": {
        "es": "Volver",
        "en": "Back"
    },
    "Hi": {
        "es": "Hola",
        "en": "Hi"
    }
}
                                    </code></pre>
                                </div>
                            </div>

                            <h2>Using Translations</h2>
                            <p>Get a specific translation:</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">example.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
from app.helpers.helpers import translate_

msg_error_login = translate_(
    key="Incorrect email or password", 
    request=request, 
    file_name="guest"
)
                                    </code></pre>
                                </div>
                            </div>

                            <p>Get all translations from a file:</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">example.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
from app.helpers.helpers import translate

all_translations = translate(
    request=request, 
    file_name="guest"
)
                                    </code></pre>
                                </div>
                            </div>
                        </article>


                        <article id="models-eng">
                            <h1>Models (SQLAlchemy)</h1>
                            <h5>Models are used to define the structure of data in
                                the application.
                            </h5>
                            <p>
                                <a href="https://www.sqlalchemy.org/" target="_blank">SQLAlchemy</a> as the default ORM
                                for
                                database management.
                                SQLAlchemy allows creating database models,
                                executing queries, and handling migrations
                                efficiently.
                            </p>

                            <h2>Using Models </h2>
                            <p>
                                The `Base` class, imported from `lila.core.database`, serves as the foundation for
                                all models .
                                Models inherit from `Base` to define database tables with SQLAlchemy.
                            </p>

                            <h2>Example: User Model</h2>
                            This example demonstrates how to create a `User` model using SQLAlchemy.
                            The model defines a `users` table with columns such as `id`, `name`, `email`, `password`,
                            `token`,
                            `active`, and `created_at`.
                            </h5>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">app/models/user.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>

        <code class="language-python">
from sqlalchemy import Table,Column,Integer,String,TIMESTAMP 
from lila.core.database import Base
from app.connections import connection 

class User(Base):
    __tablename__='users'
    id = Column(Integer, primary_key=True,autoincrement=True)
    name=Column( String(length=50), nullable=False)
    email=Column( String(length=50), unique=True)
    password=Column(String(length=150), nullable=False)
    token=Column(String(length=150), nullable=False)
    active=Column( Integer, nullable=False,default=1)
    created_at=Column( TIMESTAMP)

#Example of how to use SQLAlchemy to make queries to the database
    def get_all(select: str = "id,email,name", limit: int = 1000) -> list:
        query = f"SELECT {select}  FROM users WHERE active =1  LIMIT {limit}"
        result = connection.query(query=query,return_rows=True)#Return rows 
        return result 

#Example of how to use SQLAlchemy to make queries to the database
    def get_by_id(id: int, select="id,email,name") -> dict:
        query = f"SELECT {select}  FROM users WHERE id = :id AND active = 1 LIMIT 1"
        params = {"id": id}
        row = connection.query(query=query, params=params,return_row=True)#Retrurn row
        return row
    
    #Example using ORM abstraction in SQLAlchemy
    @classmethod
    def get_all_orm(cls, db: Session, limit: int = 1000):
        result = db.query(cls).filter(cls.active == 1).limit(limit).all()
        return result
    
    
#Example of how to use the class to make queries to the database
users = User.get_all()
user = User.get_by_id(1)
                    </code>
                    </pre>
                                </div>
                            </div>
                            <br />
                            <p>
                                For details on SQLAlchemy, visit the official documentation:
                                <a href="https://www.sqlalchemy.org/" target="_blank">SQLAlchemy Documentation</a>.
                            </p>

                        </article>

                        <article id="middlewares-eng">
                            <h1>Middlewares</h1>
                            <h5>
                                Middleware functions are used to intercept requests before they reach the main logic of
                                the application.
                                In Lila, middlewares are defined in the <code>app/middlewares</code> directory (can be
                                modified to any file and/or directory).
                                Middlewares can be used for tasks such as authentication, logging, and error handling.
                            </h5>
                            <p>
                                By default, Lila comes with 3 middlewares to start any application. Middlewares can be
                                used with decorators <code>@my_middleware</code>.
                            </p>
                            <p>
                                <code>login_required</code>, to validate that you have a signed session, for the 'auth'
                                key that is passed as a parameter to be able to modify it as you wish.
                                If this session is not found, it redirects to the URL that is passed as a parameter, by
                                default, it is <code>"/login"</code>.
                                Otherwise, it will continue its course executing the route or function.
                            </p>
                            <p>
                                Then we have <code>session_active</code>, which is used to verify if you have an active
                                session.
                                It will redirect to the URL that is received as a parameter, by default, it is
                                <code>"/dashboard"</code>.
                            </p>
                            <p>
                                The third is <code>validate_token</code>, which is used to validate a JWT token thanks
                                to the <code>get_token</code> helpers imported in
                                <code>from app.helpers.helpers import get_token</code>.
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">app/middlewares/middlewares.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>

            <code class="language-python">
from lila.core.session import Session
from lila.core.responses import RedirectResponse,JSONResponse
from lila.core.request import Request
from functools import wraps 
from app.helpers.helpers import get_token

def login_required(func,key:str='auth',url_return='/login'):
    @wraps(func)
    async def wrapper(request, *args, **kwargs):
        session_data= Session.unsign(key=key,request=request)
        if not session_data:
            return RedirectResponse(url=url_return)
        return await func(request,*args,**kwargs)
    return wrapper

def session_active(func,key:str='auth',url_return:str ='/dashboard'):
    @wraps(func)
    async def wrapper(request,*args,**kwargs):
        session_data= Session.unsign(key=key,request=request)
        if session_data:
            return RedirectResponse(url=url_return)
        return await func(request,*args,**kwargs)
    return wrapper

def validate_token(func):
    @wraps(func)
    async def wrapper(request: Request, *args, **kwargs):
        await check_token(request=request)
        return await func(request, *args, **kwargs)
       
    return wrapper


async def check_token(request:Request):
    token = request.headers.get('Authorization')
    if not token:
        return JSONResponse({'session':False,'message': 'Invalid token'},status_code=401)
    
    token = get_token(token=token)
    if isinstance(token,JSONResponse):
        return token 
                
            </code>
            </pre>
                                </div>
                            </div>

                            <br />
                            <h5>
                                Here we give you several examples of how to use all 3, with the decorators.
                            </h5>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Middlewares in routes</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">

                                    <pre>
                        <code class="language-python">
#Middleware to validate the JWT Token. 
@router.route(path='/api/token', methods=['GET','POST'])
@validate_token #Middleware
async def api_token(request: Request):
    """Api Token function"""
    print(get_user_by_id_and_token(request=request))
    return JSONResponse({'api': True}) 

#Middleware to validate session active
@router.route(path='/dashboard', methods=['GET'])  
@login_required #Middleware
async def dashboard(request: Request):  
    response = render(request=request, template='dashboard', files_translate=['authenticated']) 
    return response 


#Middleware validate if user get session active (if user get session redirect '/dashboard')
@router.route(path='/login', methods=['GET'])  
@session_active  #Middleware
async def login(request: Request):  
    response = render(request=request, template='auth/login', files_translate=['guest'])  
    return response 


                        </code>
                    </pre>
                                </div>
                            </div>

                            <h2>Security Middleware</h2>
                            <p>
                                Lila Framework includes a built-in <code>ErrorHandlerMiddleware</code> that not only
                                handles unhandled exceptions but also provides robust security checks to protect your
                                application from malicious requests. This middleware is designed to block suspicious
                                IPs, URLs, and sensitive paths, ensuring that your application remains secure.
                            </p>
                            <h3>Features</h3>
                            <ul>
                                <li>
                                    <strong>IP Blocking</strong>:
                                    Blocks IP addresses that have been flagged for malicious activity. IPs are blocked
                                    for 6 hours by default.
                                </li>
                                <li>
                                    <strong>URL Blocking</strong>:
                                    Blocks specific URLs that are known to be malicious or suspicious.
                                </li>
                                <li>
                                    <strong>Sensitive Paths Blocking</strong>:
                                    Blocks access to sensitive paths such as <code>/etc/passwd</code>,
                                    <code>.env</code>, and others.
                                </li>
                                <li>
                                    <strong>Malicious Extensions Blocking</strong>:
                                    Blocks URLs containing malicious file extensions like <code>.php</code>,
                                    <code>.asp</code>, <code>.jsp</code>, and <code>.aspx</code>.
                                </li>
                                <li>
                                    <strong>HTTP Detection</strong>:
                                    Blocks requests containing <code>"http"</code> in query parameters or body content.
                                </li>
                            </ul>
                            <h3>Configuration</h3>
                            <p>
                                The middleware uses three JSON files located in the <code>app/security</code> directory:
                            </p>
                            <ul>
                                <li><code>blocked_ips.json</code>: Stores blocked IPs with their expiration time.</li>
                                <li><code>blocked_urls.json</code>: Stores blocked URLs with their expiration time.</li>
                                <li><code>sensitive_paths.json</code>: Stores a list of sensitive paths to block.</li>
                            </ul>
                            <p>
                                If these files do not exist, they are automatically created and initialized with default
                                values:
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">security/sensitive_paths.json</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-json">
[
    "/etc/passwd",
    ".env",
    "wp-content",
    "docker/.env",
    "owa/auth/logon.aspx",
    "containers/json",
    "models",
    "autodiscover/autodiscover.json",
    "heapdump",
    "actuator/heapdump",
    "cgi-bin/vitogate.cgi",
    "CFIDE/wizards/common/utils.cfc",
    "var/www/html/.env",
    "home/user/.muttrc",
    "usr/local/spool/mail/root",
    "etc/postfix/master.cf"
]
                                    </code></pre>
                                </div>
                            </div>
                            <h3>Usage</h3>
                            <p>
                                The <code>ErrorHandlerMiddleware</code> is automatically applied to all requests. You
                                can customize its behavior by modifying the JSON files in the <code>security</code>
                                directory.
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">core/middleware.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
from starlette.middleware.base import BaseHTTPMiddleware
from lila.core.responses import JSONResponse, HTMLResponse
from lila.core.request import Request
from lila.core.logger import Logger
from datetime import datetime, timedelta
import json
import os

def load_blocked_data(file_path, default_value):
try:
if not os.path.exists(file_path):
    with open(file_path, "w") as file:
        json.dump(default_value, file, indent=4)
    return default_value

with open(file_path, "r") as file:
    content = file.read().strip()
    if not content:
        with open(file_path, "w") as file:
            json.dump(default_value, file, indent=4)
        return default_value

    try:
        return json.loads(content)
    except json.JSONDecodeError:
        with open(file_path, "w") as file:
            json.dump(default_value, file, indent=4)
        return default_value

except Exception as e:
Logger.error(f"Error loading {file_path}: {str(e)}")
return default_value

def save_blocked_data(file_path, data):
try:
with open(file_path, "w") as file:
    json.dump(data, file, indent=4)
except Exception as e:
Logger.error(f"Error saving {file_path}: {str(e)}")

async def is_blocked(blocked_data, key, request: Request):
if key in blocked_data:
expiration_time = datetime.fromisoformat(blocked_data[key]["expiration_time"])
if datetime.now() < expiration_time:
    req = await Logger.request(request=request)
    Logger.warning(f"Blocked: {key} \n {req}")
    return True
return False

class ErrorHandlerMiddleware(BaseHTTPMiddleware):
def __init__(
self,
app,
blocked_ips_file="security/blocked_ips.json",
blocked_urls_file="security/blocked_urls.json",
sensitive_paths_file="security/sensitive_paths.json",
):
super().__init__(app)
self.blocked_ips_file = blocked_ips_file
self.blocked_urls_file = blocked_urls_file
self.sensitive_paths_file = sensitive_paths_file

self.blocked_ips = load_blocked_data(blocked_ips_file, default_value={})
self.blocked_urls = load_blocked_data(blocked_urls_file, default_value={})
self.sensitive_paths = load_blocked_data(sensitive_paths_file, default_value=[])

async def dispatch(self, request, call_next):
try:
    client_ip = request.client.host
    url_path = request.url.path
    query_params = str(request.query_params)
    body = await request.body()

    if await is_blocked(self.blocked_ips, client_ip, request=request):
        return HTMLResponse(
            content="<h1>Access Denied</h1><p>Your IP has been temporarily blocked.</p>",
            status_code=403,
        )

    if await is_blocked(self.blocked_urls, url_path, request=request):
        return HTMLResponse(
            content="<h1>Access Denied</h1><p>This URL has been temporarily blocked.</p>",
            status_code=403,
        )

    malicious_extensions = [".php", ".asp", ".jsp", ".aspx"]
    if any(ext in url_path for ext in malicious_extensions):
        self.blocked_ips[client_ip] = {
            "expiration_time": (datetime.now() + timedelta(hours=6)).isoformat()
        }
        save_blocked_data(self.blocked_ips_file, self.blocked_ips)
        return HTMLResponse(
            content="<h1>Access Denied</h1><p>Malicious URL detected.</p>",
            status_code=403,
        )

    if "http" in query_params or "http" in str(body):
        self.blocked_ips[client_ip] = {
            "expiration_time": (datetime.now() + timedelta(hours=6)).isoformat()
        }
        save_blocked_data(self.blocked_ips_file, self.blocked_ips)
        return HTMLResponse(
            content="<h1>Access Denied</h1><p>Malicious query parameters detected.</p>",
            status_code=403,
        )

    if any(path in url_path or path in str(body) for path in self.sensitive_paths):
        self.blocked_ips[client_ip] = {
            "expiration_time": (datetime.now() + timedelta(hours=6)).isoformat()
        }
        save_blocked_data(self.blocked_ips_file, self.blocked_ips)
        return HTMLResponse(
            content="<h1>Access Denied</h1><p>Sensitive path detected.</p>",
            status_code=403,
        )

    Logger.info(await Logger.request(request=request))
    response = await call_next(request)
    return response

except Exception as e:
    Logger.error(f"Unhandled Error: {str(e)}")
    return JSONResponse(
        {"error": "Internal Server Error", "success": False}, status_code=500
    )
                                    </code></pre>
                                </div>
                            </div>
                        </article>


                        <article id="connections-eng">
                            <h1>Connections to database</h1>
                            <p>
                                To use connections, you need to import the <code>Database</code> class from
                                lila.core.database. With
                                that you can connect to your database, which can be SQLite, MySLQ, PostgreSQL or
                                whatever you
                                want to configure.
                            <p>Below we leave you the example of how to connect. The connection will close automatically
                                after
                                being used, so you can use it as in this example in the variable <code>connection</code>
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">app/connections.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>

            <code class="language-python">
from lila.core.database import Database

#SQLite

#Example connection to a sqlite database 
config = {"type":"sqlite","database":"test"} #test.db
connection = Database(config=config)
connection.connect()

#MySql

#Example connection to a mysql database 
config = {"type":"mysql","host":"127.0.0.1","user":"root","password":"password","database":"db_test","auto_commit":True}
connection = Database(config=config)
connection.connect()
mysql_connection = connection
                

                </code>
                </pre>
                                </div>
                            </div>

                        </article>

                        <article id="migrations-eng">
                            <h1>Migrations</h1>
                            <p>In Lila Framework, database migrations can be managed using SQLAlchemy and Lila's
                                configuration
                                to make migrations as easy as possible. The framework now supports command-line
                                migrations through Typer,
                                providing a more intuitive and flexible way to manage your database schema.
                            </p>
                            <br />

                            <h2>Migration Methods</h2>
                            <p>There are two main ways to define database tables:</p>

                            <h3>1. Using Table</h3>
                            <p>This method manually defines the table structure using SQLAlchemy's Table object.</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">cli/migrations.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
from sqlalchemy import Table, Column, Integer, String, TIMESTAMP
from app.connections import connection
import typer
import asyncio

app = typer.Typer()

# Example of creating migrations for 'users'
table_users = Table(
    'users', connection.metadata,
    Column('id', Integer, primary_key=True, autoincrement=True),
    Column('name', String(length=50), nullable=False),
    Column('email', String(length=50), unique=True),
    Column('password', String(length=150), nullable=False),
    Column('token', String(length=150), nullable=False),
    Column('active', Integer, default=1, nullable=False),
    Column('created_at', TIMESTAMP),
)

async def migrate_async(connection, refresh: bool = False) -> bool:
    try:
        if refresh:
            connection.metadata.drop_all(connection.engine)
        connection.prepare_migrate([table_users])  # for tables
        connection.migrate()
        print("Migrations completed")
        return True
    except RuntimeError as e:
        print(e)
        return False

@app.command()
def migrate(refresh: bool = False):
    """Run database migrations"""
    success = asyncio.run(migrate_async(connection, refresh))
    if not success:
        raise typer.Exit(code=1)

if __name__ == "__main__":
    app()
                                    </code></pre>
                                </div>
                            </div>

                            <h3>2. Using Models (Recommended)</h3>
                            <p>This approach defines database tables as Python classes that inherit from "Base".
                                This is the recommended method as it provides more structure and ORM capabilities.</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">app/models/user.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
from lila.core.database import Base
from sqlalchemy import Column, Integer, String, TIMESTAMP

class User(Base):
    __tablename__ = 'users'
    id = Column(Integer, primary_key=True, autoincrement=True)
    name = Column(String(length=50), nullable=False)
    email = Column(String(length=50), unique=True)
    password = Column(String(length=150), nullable=False)
    token = Column(String(length=150), nullable=False)
    active = Column(Integer, nullable=False, default=1)
    created_at = Column(TIMESTAMP)
                                    </code></pre>
                                </div>
                            </div>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">cli/migrations.py (Models version)</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
from app.connections import connection
from lila.core.database import Base  # Import Base for migrations in models
from app.models.user import User  # Import models for migrations
import typer
import asyncio

app = typer.Typer()

async def migrate_async(connection, refresh: bool = False) -> bool:
    try:
        if refresh:
            connection.metadata.drop_all(connection.engine)
        connection.migrate(use_base=True)  # for models
        print("Migrations completed")
        return True
    except RuntimeError as e:
        print(e)
        return False

@app.command()
def migrate(refresh: bool = False):
    """Run database migrations"""
    success = asyncio.run(migrate_async(connection, refresh))
    if not success:
        raise typer.Exit(code=1)

if __name__ == "__main__":
    app()
                                    </code></pre>
                                </div>
                            </div>

                            <h2>Running Migrations</h2>
                            <p>To execute migrations, use the following command in your terminal:</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Terminal Command</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-bash">
# Basic migration
python -m cli.migrations 

# Refresh all tables (drop and recreate)
python -m cli.migrations --refresh
                                    </code></pre>
                                </div>
                            </div>

                            <h3>Command Options</h3>
                            <ul>
                                <li><code>migrate</code>: Run the database migrations</li>
                                <li><code>--refresh</code>: Optional flag to drop and recreate all tables</li>
                            </ul>

                            <div class="note">
                                <p><strong>Note:</strong> When using Models, make sure to import all your model classes
                                    in the migrations file
                                    so SQLAlchemy can detect them for migrations.</p>
                            </div>
                        </article>

                        <article id="rest_api_crud-eng">
                            <h1>Simple Generation of REST API CRUD</h1>
                            <h5>At Lila, we have a simple way to generate CRUDs with automatic documentation, allowing
                                you to
                                create your REST API efficiently.</h5>

                            <p>Thanks to the combination of <strong>SQLAlchemy</strong> and <strong>Pydantic</strong>
                                models, it
                                is possible to perform data validations and execute structured queries for API
                                generation.</p>

                            <p>Additionally, you can integrate custom <strong>middlewares</strong> to validate tokens,
                                manage
                                sessions, or process requests. With just a few lines of code, you can generate a fully
                                documented REST API CRUD.</p>

                            <br />
                            <p>
                                <strong>If you haven't already, enable migrations when you start the server</strong>
                                .
                                By default it uses SQLite, it will create a database file <code>lila.sqlite</code> in
                                the
                                project root.
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">term</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="bash">
python -m cli.migrations 

</code>
</pre>
                                </div>
                            </div>
                            <br />

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">routes/api.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
from lila.core.request import Request
from lila.core.responses import JSONResponse
from lila.core.routing import Router
from pydantic import EmailStr, BaseModel
from app.middlewares.middlewares import validate_token, check_token, check_session
from app.connections import connection  # Database connection with SQLAlchemy
from app.models.user import User  # SQLAlchemy 'User' model

router = Router()# Initialize the router instance for managing API app.routes.


# Pydantic model for validations when creating or modifying a user.
class UserModel(BaseModel):
    email: EmailStr
    name: str
    token: str
    password: str

# Middleware definitions for CRUD operations
middlewares_user = {
    "get": [],
    "post": [], 
    "get_id": [],
    "put": [],
    "delete": [check_session, check_token],#Example middlewares for web session 'check_session' and jwt 'check_token'
}

# Automatically generate CRUD with validations and configurations
router.rest_crud_generate(
    connection=connection,  # Database connection
    model_sql=User,  # SQLAlchemy model
    model_pydantic=UserModel,  # Pydantic model
    select=["name", "email", "id", "created_at", "active"],  # Fields to select in queries
    delete_logic=True,  # Enables logical deletion (updates 'active = 0' instead of deleting records)
    active=True,  # Automatically filters active records ('active = 1')
    middlewares=middlewares_user,  # Custom middlewares for each CRUD action
)
                            </code></pre>
                                </div>
                            </div>

                            <br />
                            <p>You can create your own <strong>middlewares</strong> and pass them as a list to customize
                                security and validations for each <code>rest_crud_generate</code> operation.</p>
                            <p>
                                <strong>
                                    To generate the documentation, always remember to
                                    run it after the routes <code>router.swagger_ui()</code> and
                                    <code>router.openapi_json()</code>
                                </strong>
                            </p>
                            <h5>Function Parameters for <code>rest_crud_generate</code></h5>
                            <p>Below are the parameters that this function accepts to generate CRUD automatically:</p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">core/routing.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
def rest_crud_generate(
    self,
    connection,
    model_sql,
    model_pydantic: Type[BaseModel],
    select: Optional[List[str]] = None,
    columns: Optional[List[str]] = None,
    active: bool = False,
    delete_logic: bool = False,
    middlewares: dict = None,
    jsonresponse_prefix:str='',#Return with prefix list o dict 'data' first key
    
    user_id_session:bool| str=False #Example 'user id' to validate in query with where 'user_id'= id session_user
 
) :                    </code></pre>
                                </div>
                            </div>

                            <h5>Automatic Documentation</h5>
                            <p>Below is an example of the generated documentation for the
                                <code>rest_crud_generate</code>
                                function:
                            </p>
                            <p>Go to <code>http://127.0.0.1:8001/docs</code>, or as configured in your .env file (by
                                HOST and
                                PORT).</p>
                            <div>
                                <h5>GET - Retrieve all users</h5>
                                <img src="img/rest_1.png" alt="GET - Retrieve all users">
                                <br />

                                <h5>GET - Output of all users</h5>
                                <img src="img/rest_2.png" alt="GET - Output">
                                <br />

                                <h5>POST - Create new user</h5>
                                <img src="img/rest_3.png" alt="POST - Create new user">
                                <br />

                                <h5>GET_ID - Retrieve a specific user</h5>
                                <img src="img/rest_4-5.png" alt="GET_ID - Retrieve a specific user">
                                <br />

                                <h5>PUT - Update user</h5>
                                <img src="img/rest_4.png" alt="PUT - Update user">
                                <br />

                                <h5>DELETE - Delete user</h5>
                                <img src="img/rest_5.png" alt="DELETE - Delete user">
                                <br />
                            </div>
                            <br />
                            <p>In this example, we did it with 'users', but you can apply it however you want according
                                to your
                                logic ,'products','stores',etc. Even modifying the core in <code>core/routing.py</code>.
                            </p>
                            <br />
                            <p>
                                <strong>
                                    For both the 'POST' or 'PUT' method function,
                                </strong>
                                If the framework detects that you pass data in the request body such as:
                                'password' , it will automatically encode it with argon2 to make it secure.
                                Body example :
                            <pre><code class="language-json">
{
"email":"example@example.com",
"name":"name",
"password":"my_password_secret"
}
                        </code>
                        </pre>
                            </p>
                            <p>Then, if you pass 'token' or 'hash', with the <code>helper</code> function
                                <code>generate_token_value</code>
                                , it automatically generates a token, which will be saved in the database as the 'token'
                                column
                                with the value generated by the function
                                .
                                Body example :
                            <pre><code class="language-json">
{
"email":"example@example.com",
"name":"name",
"password":"my_password_secret",
"token":""
}
                        </code>
                        </pre>
                            </p>
                            <p>
                                With 'created_at' or 'created_date' , it will save the date and time of the moment, as
                                long as
                                that field exists in the database table.
                                Body example :
                            <pre><code class="language-json">
{
"email":"example@example.com",
"name":"name",
"password":"my_password_secret",
"token":"",
"created_at":""
}
                        </code>
                        </pre>

                            </p>
                            <p>
                                <strong>For the 'PUT', 'GET' (get_id) or 'DELETE' methods</strong>
                                It is optional according to the logic of each REST API, you can pass it as
                                <code>query string</code> , <code>user_id</code>
                                or <code>id_user</code>, an example would be GET, PUT or DELETE as a method
                                to the url http://127.0.0.1:8001/api/products/1?user_id=20
                            </p>
                            <p>Where it validates that the product ID '1' exists but also that it belongs to the user ID
                                '20' .
                            </p>

                        </article>

                        <article id="admin-panel-eng">
                            <h1>Admin Panel</h1>
                            <p>
                                The <code>Admin</code> module allows you to manage an admin panel for your application.
                                It includes authentication, model management, system metrics, and more. This panel is
                                highly customizable and integrates easily with your application.
                            </p>
                            <p>
                                The admin panel is now more modular and flexible. All admin-related components
                                (templates, routes, and configuration)
                                are located in the <code>admin</code> folder, making it easier to customize and extend.
                            </p>

                            <h2>Key Features</h2>
                            <ul>
                                <li><strong>Authentication</strong>: Secure login and logout for administrators.</li>
                                <li><strong>Model Management</strong>: Automatically generates routes and views to
                                    manage your models.</li>
                                <li><strong>System Metrics</strong>: Monitors memory and CPU usage for both the
                                    application and the server.</li>
                                <li><strong>Password Management</strong>: Allows administrators to change their
                                    passwords.</li>
                                <li><strong>Logs</strong>: Enables administrators to view application <code>Logs</code>.
                                </li>
                            </ul>

                            <h2>Basic Usage</h2>
                            <p>
                                To use the admin panel, you need to import the <code>Admin</code> class from
                                <code>admin.routes</code> and pass it
                                an optional list of models you want to manage. Each model must implement a
                                <code>get_all</code> method to be displayed in the admin panel.
                            </p>

                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">main.py</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
                <code class="language-python">
# English: Here we activate the admin panel with default settings.
# Espa√±ol: Aqu√≠ activamos el panel de administrador con configuraciones predeterminadas.
from app.routes.admin import Admin
from app.models.user import User
admin_routes=Admin(models=[User])
all_routes = list(itertools.chain(routes, api_routes,admin_routes))
                </code>
            </pre>
                                </div>
                            </div>

                            <h2>Setup and Migrations</h2>
                            <p>
                                Before using the admin panel, you need to run the migrations:
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Terminal</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
                <code class="language-bash">
python -m cli.migrations
                </code>
            </pre>
                                </div>
                            </div>

                            <h2>Creating Admin Users</h2>
                            <p>
                                Admin users can be created via command line with customizable parameters:
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Terminal</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
                <code class="language-bash">
# Default usage (random password generated)
python -m cli.create_admin

# With custom username and password
python -m cli.create_admin --user myadmin --password mysecurepassword
                </code>
            </pre>
                                </div>
                            </div>

                            <h2>Generated Routes</h2>
                            <p>
                                The admin panel automatically generates the following routes:
                            </p>
                            <p>
                                You can access the templates in the <code>templates/html/admin</code> folder.
                            </p>
                            <ul>
                                <li><strong>Login</strong>: <code>/admin/login</code> (GET/POST)</li>
                                <li><strong>Logout</strong>: <code>/admin/logout</code> (GET)</li>
                                </li>
                                <li><strong>Dashboard</strong>: <code>/admin</code> (GET)</li>
                                <li><strong>Model Management</strong>: <code>/admin/{model_plural}</code> (GET)</li>
                            </ul>

                            <h2>Authentication Middleware</h2>
                            <p>
                                To protect routes and ensure only authenticated administrators can access them, use the
                                <code>@admin_required</code> decorator from <code>core/admin.py</code>.
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Middleware Usage</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre>
                <code class="language-python">
from lila.core.admin import admin_required

@router.route(path="/admin", methods=["GET"])
@admin_required
async def admin_route(request: Request):
    menu_html = menu(models=models)
    return await admin_dashboard(request=request, menu=menu_html)
                </code>
            </pre>
                                </div>
                            </div>

                            <h2>System Metrics</h2>
                            <p>
                                The admin panel displays real-time metrics, including:
                            </p>
                            <ul>
                                <li>Lila framework memory usage.</li>
                                <li>Lila framework CPU usage.</li>
                                <li>System memory usage.</li>
                                <li>System CPU usage.</li>
                            </ul>
                            <p>
                                These metrics are updated every 10 seconds.
                            </p>

                            <h2>Logs</h2>
                            <p>
                                In Lila, we use a middleware that you can enable or disable if you want to use
                                <code>Logs</code> for info, warnings, or errors in your application.
                            </p>
                            <p>
                                The middleware is located in <code>core/middleware.py</code> and is added to the
                                application with:
                                <code>app.add_middleware(ErrorHandlerMiddleware)</code>.
                            </p>
                            <p>
                                This helps generate logs that you can view in the admin panel, organized by date (in
                                folders) and type.
                            </p>
                            <p class="container">
                                <img src="img/admin.png" alt="admin" />
                            </p>
                            <br />
                            <p class="container">
                                <img src="img/admin_2.png" alt="admin" />
                            </p>
                        </article>

                        <article id="minify-eng">
                            <h1>Minify files for production</h1>
                            <p>
                                With the <code>lila-minify</code> command you can minify your js, css and html files,
                                which are in the <code>public</code> and <code>templates</code> folders.
                            </p>


                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Terminal Command</span>
                                    <div class="editor-controls">
                                        <div class="control close"></div>
                                        <div class="control minimize"></div>
                                        <div class="control maximize"></div>
                                    </div>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-bash">
lila-minify 
#Or
python -m cli.minify
</code></pre>
                                </div>
                            </div>
                        </article>

                        <article id="production-eng">
                            <h1>Deployment to Production</h1>

                            <h2>Linux Server (with systemd)</h2>
                            <p>
                                To deploy your Lila application on a Linux server, it's recommended to use a virtual
                                environment and a systemd service to manage the process.
                            </p>

                            <h3>1. Create a Virtual Environment</h3>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Terminal</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-bash">
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
                                    </code></pre>
                                </div>
                            </div>

                            <h3>2. Create a Start Script</h3>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">start_lila.sh</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-bash">
#!/bin/bash
source /path/to/your/project/venv/bin/activate
python /path/to/your/project/main.py
                                    </code></pre>
                                </div>
                            </div>

                            <h3>3. Create a systemd Service</h3>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">/etc/systemd/system/lila.service</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-ini">
[Unit]
Description=Lila Framework Service
After=network.target

[Service]
User=your_user
Group=your_group
WorkingDirectory=/path/to/your/project
ExecStart=/path/to/your/project/start_lila.sh
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
                                    </code></pre>
                                </div>
                            </div>

                            <h3>4. Enable and Start the Service</h3>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">Terminal</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-bash">
sudo systemctl daemon-reload
sudo systemctl enable lila.service
sudo systemctl start lila.service
                                    </code></pre>
                                </div>
                            </div>

                            <h2>Windows Server</h2>
                            <p>
                                On Windows, you can use the Task Scheduler to run your application at startup.
                            </p>
                            <ol>
                                <li>Create a `.bat` or `.ps1` script to start your application, similar to the
                                    `start_lila.sh` script.</li>
                                <li>Open Task Scheduler.</li>
                                <li>Create a new task that runs at system startup.</li>
                                <li>Set the action to run your script.</li>
                            </ol>

                            <h2>Disable Debug Mode</h2>
                            <p>
                                In your `main.py`, make sure to turn off debug mode for production.
                            </p>
                            <div class="code-editor">
                                <div class="editor-header">
                                    <span class="editor-title">main.py</span>
                                </div>
                                <div class="editor-content">
                                    <pre><code class="language-python">
app = App(debug=False, routes=all_routes)
                                    </code></pre>
                                </div>
                            </div>
                        </article>
                        <!-- 
                <article id="helpers-eng">

                </article> -->


                    </div>



                </div>
            </div>

        </div>
    </main>


</body>

</html>